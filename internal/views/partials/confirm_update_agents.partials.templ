package partials

import (
	"fmt"
	"github.com/invopop/ctxi18n/i18n"
	"time"
)

templ ConfirmUpdateAgents(version string, all bool) {
	<div class="uk-alert border-blue-700 text-blue-700" uk-alert>
		<div class="uk-alert-description p-2">
			<form class="flex flex-col gap-2">
				<p class="uk-text-bold">
					if all {
						{ i18n.T(ctx, "admin.update.agents.confirm_update_all", version) }
					} else {
						{ i18n.T(ctx, "admin.update.agents.confirm_update_selected", version) }
					}
				</p>
				<p>
					{ i18n.T(ctx, "admin.update.agents.confirm_specify_when") }
				</p>
				<div class="flex justify-start gap-6 w-1/3">
					<input class="uk-input" name="update-agent-date" type="datetime-local" min={ fmt.Sprintf(time.Now().Format("2006-01-02T15:03")) }/>
					<button
						if all {
							hx-post="/admin/update-agents/update-all"
						} else {
							hx-post="/admin/update-agents/update-selected"
						}
						hx-target="#main"
						hx-swap="outerHTML"
						htmx-indicator="#update-spinner"
						class="uk-button border border-blue-700 bg-white text-blue-700 hover:text-blue-500"
					>
						{ i18n.T(ctx, "Schedule") }
						<div id="update-spinner" class="ml-2 htmx-indicator" hx-history="false" uk-spinner="ratio: 0.5" uk-spinner></div>
					</button>
					<button
						if all {
							hx-post="/admin/update-agents/update-all"
						} else {
							hx-post="/admin/update-agents/update-selected"
						}
						hx-target="#main"
						hx-swap="outerHTML"
						htmx-indicator="#update-spinner"
						class="uk-button bg-blue-700 text-white hover:bg-blue-500"
					>
						{ i18n.T(ctx, "Now") }
						<div id="update-spinner" class="ml-2 htmx-indicator" hx-history="false" uk-spinner="ratio: 0.5" uk-spinner></div>
					</button>
					<button
						title={ i18n.T(ctx, "Cancel") }
						type="button"
						class="uk-button uk-button-default"
						hx-get="/admin/update-agents"
						hx-push-url="true"
						hx-target="#main"
						hx-swap="outerHTML"
					>
						{ i18n.T(ctx, "Cancel") }
					</button>
				</div>
			</form>
		</div>
	</div>
}
